F.addLog("mantpl:news",{newsShow:"0200100000",recomWordShow:"1100000000",newsClick:"0200100001",hotsugClick:"0200200001",dustbinClick:"page-card-tpl-item",recomWordClick:"page-card-tpl-item",newsBanner:"0200300001",adsNewsFourTimes:"0200300002",adsEngShow:"0200300003",adsEngClick:"0200300004",topNewsImageClick:"0200100002",topNewsTextClick:"0200100003"});F.addLog("mantpl:news/index",["cardItemLog"]);F.module("mantpl:news/index_view",function(n,l,k){var p=n("superui:util/dot");function r(b){var a=this;a.perCount=16;a.passNum=16;a.curRound=1;a.topDom=b;a.ranDom=$(".s-news-rank-content",a.topDom);a.curImgNum=0;a.hotWrap=$(".new-image-pool");a.hotCtrlNum=$(".carousel-ctrl-item",a.topDom).length;a.hotCtrlWid=$(".new-image-pool .img-item",a.topDom).width();a.ctrlWrap=$(".carousel-ctrl")}r.prototype={renderHot:function(a,u,d){var c="";var g=0;var i="";var h=this;h.curRound=u;$(".news-meta-item").removeClass("news-viewed");for(var g=0;g<h.perCount;g++){var e=a[(g+h.passNum)%a.length];var v=e.title;var b=decodeURIComponent(e.url);var d=e.count;var f=h.ranDom.find('[data-index="'+g+'"]');f.removeClass("news-artist").find(".news-title .title-link .title-content").html(v).attr("href",b).end().find(".news-count").html(d).attr("title","搜索指数"+d);h.ranDom.find(".v-detail").remove();if(e.isViewed==1){f.addClass("news-viewed")}if(e.isNew==1){f.addClass("news-artist")}}h.passNum+=h.perCount},longHot:function(b){var a=this;a.perCount=12;a.passNum-=8;$(".s-news-rank-content",a.topDom).addClass("s-news-rank-long");a.renderHot(b,a.curRound)},flashImg:function(a,c){var b=this;if(!b.imgRef){b.imgRef=$(".s-news-img",b.topDom).eq(0);b.imgHeight=b.imgRef.height();b.imgWidth=b.imgRef.width()}if(c==="mouseenter"){$(".s-news-img:animated").stop().css({"margin-top":"0","margin-left":"0",width:b.imgWidth,height:b.imgHeight});a.animate({"margin-top":"-10px","margin-left":"-10px",width:b.imgWidth+20,height:b.imgHeight+20})}else{a.animate({"margin-top":"0","margin-left":"0",width:b.imgWidth,height:b.imgHeight})}},switchHotImg:function(a,b,c){var d=this;if(d.stopSwitch&&!c){return}if(!!b){var e=parseInt(d.curImgNum,10)+a;e=e<0?(e+d.hotCtrlNum):e;d.curImgNum=e%d.hotCtrlNum}else{if(a){d.curImgNum=a}else{d.curImgNum=(parseInt(d.curImgNum,10)+1)%d.hotCtrlNum}}clearTimeout(d.cTimmer);d.ctrlWrap.find(".carousel-ctrl-cur").removeClass("carousel-ctrl-cur").end().find('[data-index="'+d.curImgNum+'"]').addClass("carousel-ctrl-cur");d.hotWrap.stop().animate({left:(-1*d.curImgNum*d.hotCtrlWid)+"px"},function(){d.carousel()})},carousel:function(){var a=this;a.cTimmer=setInterval(function(){a.switchHotImg(1,true)},5000)},createRecom:function(b,a){_ctx=this;$.ajaxpost(s_domain.baseuri+"/news/data/newrelatewords",{title:$.trim($(b).find("h2 .s-yahei").text()),rid:$(b).attr("data-rid")},function(d){var f=d.errNo,h=d.data;if(f=="0"){var i=_ctx.topDom.find(".c-recommend");if(i){i.remove()}var g="";for(var c=0;c<h.length;c++){g=g+'<a href="'+decodeURIComponent(h[c].recomHref)+'" target="_blank" class="recom-link">'+h[c].recomTitle+"</a>"}var e='<div class="c-recommend"><i class="c-icon"></i><span class="c-gray">为您推荐：</span>'+g+"</div>";$(b).find(".from").after(e);a&&a(b)}else{if(f=="501"){}}})},getRecomWords:function(c){var a=[],b=$(c).find(".c-recommend a");for(var d=0;d<b.length;d++){a.push('"'+$.trim($(b[d]).text())+'"')}return a},getEngWords:function(c){var a=[],b=$(c).find(".s-news-content-imgs a");for(var d=0;d<3;d++){a.push($.trim($(b[d]).attr("data-itemId")))}return a},getHotWords:function(){var c=[],a=this.ranDom.find(".title-content");for(var b=0;b<a.length;b++){c.push('"'+$.trim($(a[b]).text())+'"')}return c},waitView:function(b,d,a){var c=this;if(b.type==="mouseenter"){c.ranDom.find(".v-detail").hide();clearTimeout(c.onTimer);clearTimeout(c.offTimer);c.onTimer=setTimeout(function(){d.parents(".news-meta-item");o()},500)}else{if(b.type==="mouseleave"){clearTimeout(c.onTimer);c.hideDetail(d)}}},viewDetail:function(b,c){var e=$.trim($(".title-content",b).html()),a=this;for(var f in c){if(c[f].title===e){c[f].isNew=0;c[f].isViewed=1;break}}var d=$(".s-news-rank-list .one-item",a.topDom).length;$.ajaxget("/home/news/data/mannewssug?word="+e,function(v){if(v.data.length<1){return}var g=b.offset().top-$(".s-news-rank-content",a.topDom).offset().top+20;var i=parseInt(b.closest("[data-index]").attr("data-index"));if(i>7){g-=130}if($.browser.firefox){g+=10}else{if($.isIE==6){g-=3}}var u=m(v.data,g,(i>7),+i%2);if(!!u){var h=$(u);b.append(h);if($.isIE===6){setTimeout(function(){h.css({zoom:1})},200)}}})},showDetail:function(a,c){var b=a.find(".v-detail");a.parents(".s-news-rank-content").find(".v-detail").hide();if(b[0]){b.show()}else{this.viewDetail(a,c)}return true},hideDetail:function(a){a.find(".v-detail").hide()}};function m(e,d,c,f){var a='<div class="v-detail#{down}#{right}" style="top:#{top}px;"><div class="detail-content">#{content}<div class="v-arrow"><em></em></div></div></div>';if(!e||!e.length){return false}var b=q(e[0])+j(e[0])+q(e[1]);return $.formatString(a,{content:b,top:d,down:c?" v-down":"",right:f?" v-right":" v-left"})}function q(a){if(!a){return""}a.url=decodeURIComponent(a.url);var b='<div class="hot-words-item"><span class="dot"></span><a class="word-title" href="#{url}" target="_blank" title="#{realtitle}">#{title}</a></div>';return $.decodeHTML($.formatString(b,a))}function j(a){var b='<div class="hot-words-summary">#{summary}</div>';return $.decodeHTML($.formatString(b,a))}function o(){k.fire("hotsugClick",{clickType:"layerShow",newsType:"words"})}return r});F.module("mantpl:news/ck",function(p,C,q){var v=/link\?url\=([^\&]+)/;var u=/\?url\=([^\.]+)\./;var x={};x.nativeadStorageMap={};function A(a){if(!x.nativeadStorageMap[a]){x.nativeadStorageMap[a]={firstOverCoordinateX:undefined,firstOverCoordinateY:undefined,mousedownX:0,mousedownY:0,mouseoverTimes:0,latestMouseoverTime:0,latestMousedownTime:0,latestMouseupTime:0,diffMousedownAndMouseoverTime:0,diffMouseupAndMousedownTime:0}}return x.nativeadStorageMap[a]}function r(a){while(a&&a.tagName!=="A"){a=a.parentNode}return a}function s(a){var c=a.href;var b=v.exec(c)||u.exec(c);return b?b[1]:false}function D(a,e,d){var c=s(d);if(c!==false){var b=t(c,a,e);y(b,e,d)}}function y(d,c,b){var e=A(c);var a="&ck="+[d,e.mouseoverTimes,e.diffMouseupAndMousedownTime,e.mousedownX,e.mousedownY,e.firstOverCoordinateX,e.firstOverCoordinateY,e.diffMousedownAndMouseoverTime].join(".");if(b.href){var f=b.href;if(f.indexOf("&ck=")===-1){b.href+=a}else{b.href=f.replace(/&ck=[\d.]*/,a)}}}function t(c,g,f){var a=0;var b=A(f);for(var d=0;d<(((b.mouseoverTimes*g)%99)+9);d++){var e=c.length<20?c.length:20;a+=c.charCodeAt((b.diffMouseupAndMousedownTime*d)%c.length)}return a}function w(a,c){a=a||window.event;var b=A(c);b.mouseoverTimes++;if(b.firstOverCoordinateX===undefined){b.firstOverCoordinateX=a.clientX}if(b.firstOverCoordinateY===undefined){b.firstOverCoordinateY=a.clientY}b.latestMouseoverTime=new Date().getTime()}function z(a,b,e){a=a||window.event;var c=A(e);var d=a.target||a.srcElement;d=r(d);c.latestMousedownTime=new Date().getTime();c.diffMouseupAndMousedownTime=9999;c.mousedownX=a.clientX;c.mousedownY=a.clientY;if(c.latestMouseoverTime===0){c.diffMousedownAndMouseoverTime=0}else{c.diffMousedownAndMouseoverTime=c.latestMousedownTime-c.latestMouseoverTime}D(b,e,d)}function B(a,b,e){a=a||window.event;var c=A(e);var d=a.target||a.srcElement;d=r(d);c.latestMouseupTime=new Date().getTime();c.diffMouseupAndMousedownTime=c.latestMouseupTime-c.latestMousedownTime;D(b,e,d)}return{saveMouseoverInfo:w,saveMousedownInfo:z,saveMouseupInfo:B}});F.module("mantpl:news/card_alsLog",function(h,j,k){function l(b){var c="imglog__"+(new Date()).getTime();var a=window[c]=new Image();a.onload=(a.onerror=function(){window[c]=null});a.src=b;a=null}var i={CLICK:2,SHOW:3};function g(){this.init()}g.prototype={constructor:g,init:function(){this.alsHostHttp="http://als.baidu.com/clog/clog";this.alsHostHttps="https://als.baidu.com/clog/clog";var a=39;var c=0;var b=$.cookie.get("BAIDUID");this.alsCommonFields=this.buildAlsParams(a,c,b)},buildAlsParams:function(a,c,b){return{productId:a,_client_type:c,baiduId:b}},sendAls:function(c){var b=[];for(var a in c){b.push([encodeURIComponent(a),"=",encodeURIComponent(c[a])].join(""))}l(this.alsHostHttps+"?"+b.join("&"))},buildAlsLogData:function(c,a){var b=encodeURIComponent($.stringify([$.extend({da_page:"index",da_page_num:1,da_locate:1,origin_time:+new Date()},a)]));return $.extend({},this.alsCommonFields,c,{ad:b})},sendAlsClickLog:function(a,b){this.sendAls(this.buildAlsLogData(a,$.extend(b,{da_type:i.CLICK})));return this},sendAlsShowLog:function(a,b){this.sendAls(this.buildAlsLogData(a,$.extend(b,{da_type:i.SHOW})));return this}};return new g()});F.module("mantpl:news/index",function(u,v,C){var J=u("superui:util/dot");var I=$.parseJSON($("#news_hot_data").html());var B=window.Thunder.get();var M=$.parseJSON($("#news_banner_data").html());var H=u("mantpl:news/index_view");var w=$("#s_xmancard_news");var L=$(".s-news-banner-wrap");var z=new H(w);var t=u("mantpl:news/ck");var D=u("mantpl:news/card_alsLog");var y=2;var E=u("superui:component/tips");var x=new E({target:$("#head"),identity:"ExceedTipsNews",content:"今天召唤我太多次啦，</br>明天再来调教小度吧！`(*∩_∩*)′",timing:2000,autoShow:false,theme:"exceedtipnews"});var A=0;var G=[];function K(){this.onTimer=null;this.offTimer=null;this.hotRound=1}K.prototype={constructor:K,init:function(){this.blockName="news";this.addEvent();this.fix();this.saveFistRids();var a=this.stringify(z.getHotWords());C.fire("newsShow",{showType:"hotword",words:a,pagenum:"0"});$(".s-news-rank-wrapper .s-rank-title").addClass("s-opacity-border1-bottom");this.itemNum=$(".s-news-item").length},stringify:function(a){return"["+a.join(",")+"]"},setTopDom:function(a){w=a},fix:function(){w.find(".s-news-item:eq(0)").addClass("first")},saveFistRids:function(){w.find(".s-news-list-wrapper:first .s-news-item").each(function(){if($(this).attr("data-rid")){G.push($(this).attr("data-rid"))}else{G.push("0")}})},getNotNewsPos:function(a){var b=0;w.find(".s-news-item").each(function(c){if($(this).hasClass(a)){b=c;return false}});return b},showLayer:function(b,c){var a,d=this;if($.isIE6){a=$(window).height()/2+$(window).scrollTop()}else{a="50%"}F.use("superui:component/dialog",function(e){d.DelPannel=new e({identity:"newsDel",content:'<div class="pannel-content">确定不感兴趣吗？</br>以后这类信息会少出现哒！(=￣ω￣=)✧</div>',hasClose:true,theme:d.blockName+"-pannel",autoShow:true,width:400,top:a,dus:c,buttons:[function(f){d.sendTip(f);if($(c).hasClass("extends-dustbin")){d.delExtends(c,1)}else{d.delNew(c)}C.fire("dustbinClick",{nodename:"ok"})},function(){C.fire("dustbinClick",{nodename:"cancel"})}]});if($.isIE===6){$("#sui-dialog-mask").height($(document.body).height())}});$(".sui-dialog-footer").prepend('<a href="javascript:;" onclick="return false;" class="noremind"><i class="checkbox"></i>不再提示</a>');if(b=="1"||b=="2"){$(".checkbox").addClass("checkboxbk")}$(".sui-dialog-news-pannel").delegate(".noremind","click",function(e){$(".checkbox").toggleClass("checkboxbk");C.fire("dustbinClick",{nodename:"noremind"});e.stopPropagation()})},sendTip:function(a){var b=a.target.prev().find(".checkbox");if(b.hasClass("checkboxbk")){F.use("superman:common/user_attr",function(c){c.setAttr("delrecLayer","1")})}else{F.use("superman:common/user_attr",function(c){c.setAttr("delrecLayer","0")})}},delNew:function(a){_ctx=this;$.ajaxpost(s_domain.baseuri+"/news/submit/mannewsoperation",{cmd:"remove",id:$(a).parents(".s-news-item").attr("data-rid")},function(d){var e=d.errNo;if(e=="0"){var c=$(a).parents(".s-news-item");var b=c.parents(".s-news-list-wrapper");_ctx.sendThunderDislike(c);c.remove();if(b.children().length==0){b.remove()}$(".s-news-list-wrapper .s-news-item:first").addClass("first");_ctx.itemNum--;if(_ctx.itemNum<7){F.call("mancard:skeleton/presenter","judgeFire")}}else{if(e=="501"){x.show();if($.isIE6){x.tips.css({top:$(window).height()/2+$(window).scrollTop()})}else{x.tips.css({top:"50%"})}}}})},delNativeAd:function(a){var b=$(a).parents(".s-news-item");var c=b.parents(".s-news-list-wrapper");this.sendThunderDislike(b);b.remove();if(c.children().length==0){c.remove()}$(".s-news-list-wrapper .s-news-item:first").addClass("first");this.itemNum--;if(this.itemNum<7){F.call("mancard:skeleton/presenter","judgeFire")}},sendThunderDislike:function(g){var e=$(g),b=false,k="",a="",c="",o="",m="",i=false;extra="";while(e.attr("data-rid")==undefined&&e.attr("id")!="s_ctner_contents"){if(e.attr("data-click")!=undefined){i=true;k=e.attr("data-click").toLowerCase();a=g.nodeName.toLowerCase();if(k=="log_link"){if(e[0]&&e[0].nodeName&&e[0].nodeName.toLowerCase()=="a"){o=$.trim(e.attr("data-title"))||$.trim(e.attr("title"))||$.trim(e.text());var p=$.trim(e.attr("href"));if(!p.indexOf("#")==0&&!p.indexOf("javascript")==0){m=p}}if(a!="img"){a="a"}k="outlink"}else{if(k.indexOf("log_btn")!=1){c=k.replace("log_btn_","");k="btn";m="";o=$.trim(e.attr("data-title"))||$.trim(e.attr("title"))||$.trim(e.text())}}}e=e.parent();if(e.attr("data-extra")){extra=e.attr("data-extra")}}var d={cst:2,tid:52,logExtra:{rid:e.attr("data-rid"),url:e.attr("data-url"),clicktype:k,title:o,flow:2,extra:extra,source:[],tag:[],content:[]}};var f=e.attr("data-log"),l=[];if(f){f=f.replace(/\;$/g,"");l=f.split(";");var n=[];var h="";var j="";for(var q=0;q<l.length;q++){n=l[q].split(":");h=n[0];j=n[1];d.logExtra[h]=j}}d.logExtra=$.stringify(d.logExtra);d.logInfo="l4";B.send(d)},delExtends:function(b,a){_ctx=this;$.ajaxpost(s_domain.baseuri+"/other/submit/setadstatus",{sortname:"adsNewsFour",aid:$(b).attr("data-aid")},function(d){var e=d.errNo;$.localstorage.remove("adsNewsFourTimes");if(e=="0"&&a){var c=$(b).parents(".s-news-item");var f=c.parents(".s-news-list-wrapper");_ctx.sendThunderDislike(c);c.remove();if(f.children().length==0){f.remove()}$(".s-news-list-wrapper .s-news-item:first").addClass("first");_ctx.itemNum--;if(_ctx.itemNum<7){F.call("mancard:skeleton/presenter","judgeFire")}C.fire("adsNewsFourTimes",{clickType:"close"})}else{if(e=="501"){x.show();if($.isIE6){x.tips.css({top:$(window).height()/2+$(window).scrollTop()})}else{x.tips.css({top:"50%"})}}}})},decreaseExtends:function(){var d=this;var c=w.find(".extends-dustbin");var b=c.closest(".s-news-item");if(c.length){C.fire("adsNewsFourTimes",{clickType:"show"});var a=c.attr("data-aid");if($.localstorage.get("adsNewsFourAid").value!=a){$.localstorage.remove("adsNewsFourTimes");$.localstorage.set("adsNewsFourAid",a)}if($.localstorage.get("adsNewsFourTimes").value=="NaN"){$.localstorage.set("adsNewsFourTimes",c.attr("data-times"))}else{if($.localstorage.get("adsNewsFourTimes").value){$.localstorage.set("adsNewsFourTimes",parseInt($.localstorage.get("adsNewsFourTimes").value)-1)}else{$.localstorage.set("adsNewsFourTimes",c.attr("data-times"))}}if($.localstorage.get("adsNewsFourTimes").value<="1"){d.delExtends(c);return}}},addEvent:function(){var d=this;var e=$(".s-news-list-wrapper",w);var a;w.delegate(".s-news-item, .rn-pnews","mouseenter",function(f){if($.isIE===6){$(".dustbin",this).css("display","block")}f.stopPropagation()}).delegate(".s-news-item, .rn-pnews","mouseleave",function(f){if($.isIE===6){$(".dustbin",this).css("display","none")}f.stopPropagation()}).delegate(".dustbin","click",function(f){_ctxdus=this;$.ajaxget(s_domain.baseuri+"/other/data/mancardlayer?tabid="+window.s_session.curmod,function(g){var h=g;if(h.showFloat=="0"){if($(_ctxdus).hasClass("extends-dustbin")){d.delExtends(_ctxdus,1)}else{d.delNew(_ctxdus)}}else{d.showLayer(h.noremind,_ctxdus)}});a&&a.close();f.stopPropagation()}).delegate(".dustbin","mouseenter",function(f){_ctxdus=$(this);a=new E({target:_ctxdus,identity:"noInterestTipsNews",content:"不感兴趣",autoShow:true,arrowUp:false,arrowLeft:"center",align:"center",theme:"nointeresttipnews"});$(".sui-tips-nointeresttipnews").css({top:"-=4"});f.stopPropagation()}).delegate(".dustbin","mouseleave",function(f){a&&a.close();f.stopPropagation()}).delegate(".s-news-item a[href]","click",function(f){if(!$(this).attr("data-src")){var g=$(this).parents(".s-news-item");g.addClass("news-viewed");if(s_session.sid.indexOf("18836")>-1&&g.attr("data-relatewords")&&$(this).find(".from")){z.createRecom(g,function(i){var h=d.stringify(z.getRecomWords(i));C.fire("recomWordShow",{opType:"recomshow",rid:i.attr("data-rid"),words:h})});d.sendRecomLog(g)}d.handleCRids($(this).parents(".s-news-item").attr("data-rid"))}f.stopPropagation()}).delegate(".s-news-item a[href]","mousedown",function(f){var g=$(this).parents(".s-news-item");if(!$(this).attr("data-src")){if(!/pos-0/g.test(g.attr("data-log"))){g.attr("data-log",g.attr("data-log")+"pos-0:"+G.indexOf(g.attr("data-rid"))+";")}if(g.find(".dustbin").hasClass("extends-dustbin")){var h=g.find(".s-text-content h2 a");C.fire("adsNewsFourTimes",{clickType:"click",url:h.attr("href")})}if(g.hasClass("eng-hot-word")){C.fire("adsEngClick",{clickType:"click",itemId:$(this).attr("data-itemId")||g.attr("data-itemId"),url:$(this).attr("href"),pos:d.getNotNewsPos("eng-hot-word"),subpos:$(this).attr("data-pos"),title:$.trim($(this).find(".s-news-text").text())||$(this).attr("title")})}}else{if(g.hasClass("eng-hot-word")){C.fire("adsEngClick",{clickType:"srcClick",url:$(this).attr("href"),pos:d.getNotNewsPos("eng-hot-word"),title:$.trim($(this).text()),itemId:g.attr("data-itemId")})}}}).delegate(".nativead-dustbin","click",function(f){_ctxdus=this;d.delNativeAd(_ctxdus);f.stopPropagation()}).delegate(".s-nativead-item a[href]","click",function(f){var g=$(this).parents(".s-nativead-item");D.sendAlsClickLog({},{da_locate:+g.attr("data-locate"),extra_param:g.attr("data-extra-param")})}).delegate(".s-nativead-item a[href]","mousedown",function(f){var g=$(this).parents(".s-nativead-item");if(g.attr("data-imTimeSign")){t.saveMousedownInfo(f,g.attr("data-imTimeSign"),g.attr("data-rid")||"0")}}).delegate(".s-nativead-item a[href]","mouseup",function(f){var g=$(this).parents(".s-nativead-item");if(g.attr("data-imTimeSign")){t.saveMouseupInfo(f,g.attr("data-imTimeSign"),g.attr("data-rid")||"0")}}).delegate(".s-nativead-item a[href]","mouseover",function(f){var g=$(this).parents(".s-nativead-item");if(g.attr("data-imTimeSign")){t.saveMouseoverInfo(f,g.attr("data-rid")||"0")}}).delegate(".s-news-rank-wrapper .hot-refresh","click",function(f){z.renderHot(I.banner,d.hotRound++);C.fire("newsClick",{clickType:"wordsChange"});A++;var g=d.stringify(z.getHotWords());C.fire("newsShow",{showType:"hotword",words:g,pagenum:A})}).delegate(".news-title .title-link","mouseenter mouseleave",function(f){z.waitView(f,$(this),I.banner);f.stopPropagation()}).delegate(".news-title .title-link a","click",function(f){$(this).parents(".news-meta-item").removeClass("news-viewed").removeClass("news-artist").addClass("news-viewed");var g=$.trim($(this).html());$.ajaxpost("/home/news/submit/mannewsview",{title:g});for(var h in I.banner){if(I.banner[h].title==$.decodeHTML($.trim($(this).html()))){I.banner[h].isViewed=1;I.banner[h].isNew="0"}}}).delegate(".title-content","click",function(f){var g=$(this);C.fire("newsClick",{clickType:"wordTopic",newsType:"words",url:$(this).attr("href"),title:$(this).text(),pagenum:A,newsindex:$(this).closest(".news-meta-item").attr("data-index")});f.stopPropagation()}).delegate(".word-title","click",function(f){var g=$(this);C.fire("hotsugClick",{clickType:"wordTopic",newsType:"words",url:$(this).attr("href")});f.stopPropagation()}).delegate(".title-text a","click",function(f){C.fire("hotsugClick",{clickType:"wordTopic",newsType:"topLink",url:$(this).attr("href")})}).delegate("s_news_banner","click",function(f){C.fire("hotbannerClick",{clickType:"",newsType:"topLink",url:$(this).attr("href")})}).delegate(".s-news-banner-wrap","click",function(){C.fire("newsBanner",{clickType:"click",url:M.url,title:M.title,bannerId:M.bannerId})}).delegate(".s-text-banner [data-click]","click",function(f){C.fire("topNewsTextClick",{clickType:$(this).attr("data-click"),url:$(this).attr("href")||$(this).parent().attr("href")});f.stopPropagation()}).delegate(".s-image-banner [data-click]","click",function(f){C.fire("topNewsImageClick",{clickType:$(this).attr("data-click"),url:$(this).attr("href")||$(this).parent().attr("href")});f.stopPropagation()});if($.isIE!==6){d.browserFollow()}else{d.ieFollow()}var c=false;var b=false;C.listen("mancard:skeleton/card","cardloaded",function(l){if(l.loadData.rids){for(var k=0;k<l.loadData.rids.length;k++){G.push(l.loadData.rids[k])}}if(+l.cardId===+y){w.removeClass("s-news-split")}if(l.cardId==y&&(!b)){b=true;d.decreaseExtends();if(w.find(".s-news-item.eng-hot-word").length){var h=true;var o=w.find(".s-news-item.eng-hot-word");$(window).on("scroll",function(){if(($(window).height()+$(document).scrollTop())>=(o.offset().top+o.height()/2)&&h){setTimeout(function(){var q=d.stringify(z.getEngWords(o));if($(o).hasClass("eng-word")){C.fire("adsEngShow",{showType:"show",pos:d.getNotNewsPos("eng-hot-word"),itemId:q})}else{C.fire("adsEngShow",{showType:"show",pos:d.getNotNewsPos("eng-hot-word"),itemId:$(o).attr("data-itemId")})}h=false},100);h=false}})}}if(l.cardId==y&&z.perCount!=12&&l.loadData.isEnd=="0"){d.itemNum+=5;if(!c){c=true;if(M&&!!(+M.isViewed)){var g=$.url.escapeSSL(decodeURIComponent(M.img));L.css("background","url("+g+") no-repeat");L.removeClass("news-banner-hidden");C.fire("newsBanner",{clickType:"show",title:M.title,bannerId:M.bannerId})}}else{z.renderHot(I.banner,d.hotRound++);var p=d.stringify(z.getHotWords());A++;C.fire("newsShow",{showType:"hotword",words:p,pagenum:A})}var f=w.attr("data-waterpara").split(";");var j=0;for(var k in f){var n=f[k].split("=");var m=n[0];var i=n[1];if(m=="pos"){j=parseInt(i)}}w.attr("data-waterpara","version="+l.loadData.version+";pos="+(j+$(l.loadData.html).children().length)+";"+l.loadData.waterpara)}});C.listen("superui:component/dialog","dialogHide",function(f){var g=f.obj.options("dus");if($.isIE===6){var h=$(g).parents(".item-wrapper");$(g).css("display","none");$(".subscribe",h).css("display","none");$(".img-click",h).css("display","block")}})},roller:function(h,i,e,c){if(!this.nWrap){this.nWrap=$(".s-news-wrapper",w);this.nOffset=this.nWrap.offset()}var a=this.nWrap;var d=h.offset();var b=h.height();var f=w.width();var g=this.nOffset;if(a.offset().top-(d.top+b)<c&&e&&w.is(":visible")){i.css({position:"fixed",top:Math.min(b+c,a.height()+g.top-$(window).scrollTop()-i.outerHeight(true)),right:($(window).width()-(g.left+f)-20+$(window).scrollLeft())})}else{i.css({position:"absolute",top:0,right:"5px"})}},browserFollow:function(){var e=$(".s-news-rank-wrapper",w);var a=$("#s_top_wrap");var c=this;var b=false;function d(f){if(!a.find("#s_menu_gurd")[0]){c.roller(a,e,b,15)}else{c.roller(a,e,b,30)}}C.listen("superman:page/scroll","outMenu",function(f){if(f.out===true){b=true;$(window).bind("scroll",d);$(window).bind("resize",d)}else{b=false;$(window).unbind("scroll",d);$(window).unbind("resize",d);e.removeAttr("style")}});$(window).bind("resize",function(){if(!c.nWrap){c.nWrap=$(".s-news-wrapper",w)}c.nOffset=c.nWrap.offset()});C.listen("mancard:skeleton/presenter","switchCard",function(f){if(+f.toCard===y){if(!c.nWrap){c.nWrap=$(".s-news-wrapper",w)}c.nOffset=c.nWrap.offset()}})},ieFollow:function(){var e=$(".s-news-rank-wrapper",w);var c=$("#s_ctner_contents");var d=0;var b=e.height();function a(){if($(this).scrollTop()>d){_top=Math.min(Math.max($(this).scrollTop()-322,0),Math.abs(c.height()-b-100))}else{_top=Math.min(Math.max($(this).scrollTop()-290,0),Math.abs(c.height()-b-100))}e.stop().animate({top:_top});d=$(this).scrollTop()}$(window).bind("scroll",a)},sendRecomLog:function(a){var b=this;var c;a.delegate(".recom-link","click",function(d){$(this).css("color","#666");var e=b.stringify(z.getRecomWords(a));C.fire("recomWordClick",{nodename:"recomLink",url:$(this).attr("href")||"",title:$.trim($(this).text())||"",rid:a.attr("data-rid"),words:e});d.stopPropagation()}).delegate(".recom-link","mouseenter",function(d){var e=this;c=setTimeout(function(){var f=b.stringify(z.getRecomWords(a));C.fire("recomWordShow",{onType:"hover",url:$(e).attr("href")||"",title:$.trim($(e).text())||"",rid:a.attr("data-rid"),words:f})},500);d.stopPropagation()}).delegate(".recom-link","mouseleave",function(d){clearTimeout(c)})},handleCRids:function(b){var a=window.s_session.crids||(window.s_session.crids="");if(!!b){var c=[];!!a&&(c=a.split(","));c.indexOf(b)===-1||(c.splice(c.indexOf(b),1));c.unshift(b);c.length>10&&(c.length=10);var d=c.join();window.s_session.crids=d}}};return new K()});F.use("mantpl:news/index",function(b){b.init()});