F.addLog("mancard:skeleton/card",{scrollLoad:"4010311000"});F.module("mancard:skeleton/card",function(f,g,h){var e=(function(){var m=/<link[^>]*href="(.*?)"[^>]*>/;var c=$("#s_menus_wrapper");var n=$("#s_ctner_menus");var d="";function o(k,j,i){this.id=(""+k)||"";this.loaded=0;this.offsetUsed=false;this.html="";this.name=j||"";this.state=i||"";this.mainDom=$("#s_content_"+this.id);this.mainDom=this.mainDom[0]?this.mainDom:a({id:this.id});this.waterDom=null;this.noMore=false;this.myMen=null;this.rendered=false;this.waterPage=0;this.waterLoading=false;this.cutnetTimes=0;this.prevRidsArr=window.s_session.rids||[];this.repeatNum=0;this.ridsHash={};this.params={};this.forceLoad=false}o.prototype={constructor:o,load:function(j){var i=this;if(i.id!=""){if(i.loaded===0||i.forceLoad){i.loaded=1;i.params.id=i.id;b(i.params,function(s){i.loaded=2;i.sessionId=s.sessionId;i.prevRidsArr=s.rids;for(var t=0,k=s.rids||[],l=k.length;t<l;t++){i.ridsHash[k[t]]=true}i.html=s.html.replace(m,"");if(s.isEnd==1){i.noMore=true}i.loadCss(s.html,j)})}}},loadCss:function(k,j){var l,i;if(k){l=k.match(m);if(l){i=l[1];$('<link rel="stylesheet" type="text/css" href="'+i+'" />').on("load",function(){j&&j(k)}).appendTo(head);if($.browser.safari&&window.navigator.platform==="Win32"){j&&j(k)}}else{j&&j(k)}}else{h.fire("syncNomore",{cardId:this.id})}},appendData:function(v,k,z){var x=this;if(x.noMore||x.waterLoading||!x.rendered){if(x.noMore){k&&k(false)}return false}if(!x.loadDom){x.loadDom=x.mainDom.find(".s-loading")}x.waterLoading=true;k&&k(false);var l={id:x.id,offset:x.waterPage,sessionId:x.sessionId,crids:window.s_session.crids};var j=(x.mainDom||$("#s_content_"+x.id));var w=j.attr("data-waterpara");if(!w&&j.find(".s-xmancard").attr("data-waterpara")){w=j.find(".s-xmancard").attr("data-waterpara")}if(w){var y=/([s\S]*?)\=([\s\S]*?)\;/g;var i=null;while((i=y.exec(w))){if(i[1]==="offset"){if(!x.offsetUsed){l[i[1]]=i[2];x.waterPage=i[2];x.offsetUsed=true}}else{l[i[1]]=i[2]}}}h.fire("beforeLoading");x.loadDom.show();h.fire("scrollLoad");F.use("mancard:skeleton/model",function(q){q.get("waterHtml",function(s){if(!x.waterDom){x.waterDom=$(".water-container",x.mainDom)}if(l.childId==="1_1"&&l.sessionId==="0"){x.ridsHash={}}var t=x.validateRid(s);var r=[function(){var u=z||x.waterDom;u.append(s.html);x.waterLoading=false;x.loadDom.hide();if(s.isEnd=="1"){x.emitNoMore(x.loadDom);x.noMore=true}x.waterPage++;x.mainDom.attr("data-loaded",1);if(x.id===2&&s.isEnd==="0"){x.mainDom.find("div[data-waterpara]").attr("data-waterpara","version="+s.version+";"+s.waterpara)}h.fire("cardloaded",{cardId:x.id,loadData:s});v&&v.call(x,s)},function(){x.waterLoading=false;x.appendData(v,k)},function(){x.waterLoading=false;x.appendData(v,k)},function(){x.waterLoading=false;x.appendData(v,k)},function(){$.ajaxpost(s_domain.baseuri+"/page/data/pageserver",{errno:7009});x.emitNoMore(x.loadDom);x.noMore=true}];d=(d===""||d==1)?"1":undefined;x.cutnetTimes=0;r[t]()},l).fail(function(){$.ajaxpost(s_domain.baseuri+"/page/data/pageserver",{errno:8001});x.cutnetTimes++;if(x.cutnetTimes<=3){x.waterLoading=false;x.appendData(v,k)}else{x.emitNoMore(x.mainDom.find(".s-loading"))}})});return true},validateRid:function(s){var k=this;var t=s.rids||[];var i=0;for(var j=0,l=t.length;j<l;j++){if(!!t[j]&&!!k.ridsHash[t[j]]){i=1}k.ridsHash[t[j]]=true}if(i===1){k.repeatNum++}else{if(k.repeatNum>0){k.repeatNum=0}}k.prevRidsArr=t;return k.repeatNum},render:function(j){var i=this;$("#s_ctner_contents").append(this.mainDom);i.load(function(l){var k=$(i.html);i.mainDom.html(k);if(i.noMore){i.emitNoMore(i.mainDom.find(".s-loading"))}i.rendered=true;j&&j();h.fire("cardinitloaded")});return i},add2Men:function(j){var i=this;if(!i.myMen){var k=p({id:this.id,name:this.name});i.myMen=$(k)}if(this.id==="3"){c.parent().append(i.myMen);F.call("newmusic:index","init")}else{c.append(i.myMen)}i.myMen.show();i.render();return i},del4Men:function(j){var i=this;if((i.myMen=$("[data-id="+this.id+"]",c))[0]){i.myMen.hide();i.mainDom.hide();i.state=""}return i},show:function(j){var i=this;if(this.rendered){if(d==1&&this.waterPage==0){this.appendData(function(k){})}this.mainDom.stop().show()}else{this.render(function(){j&&j.call(this)});this.mainDom.stop().show()}j&&j.call(this);this.getMyMen().addClass("current");return this},hide:function(i){this.mainDom.stop().hide();this.getMyMen().removeClass("current");i&&i.call(this);return this},getMyMen:function(){return this.myMen||(this.myMen=$("[data-id="+this.id+"]",n))},emitNoMore:function(i){i=i||this.mainDom.find(".s-loading");i.find(".load-text").addClass("no-more").html("没有更多内容了").end().find("img").hide().end().prepend('<div class="load-done"></div>').show();if(this.id==100||this.id=="1"||this.id=="22"||this.id==24){i.hide()}h.fire("cardLoadDone",{cardId:this.id})},resetNoMore:function(i){i=i||this.mainDom.find(".s-loading");i.hide().find(".load-text").removeClass("no-more").html("正在加载中").end().find("img").show().end().find(".load-done").remove()},setForceLoad:function(i){this.forceLoad=i},addParam:function(j,i){this.params[j]=i}};function p(i){var j;if(i.id==="3"){j='<div class="s-menu-music" data-id="#{id}"></div>'}else{if(i.id==="5"){j=['<span class="s-menu-item s-opacity-white-background" data-id="#{id}">',"<span>#{name}</span>",'<span class="bar-bg" data-tid="7779"></span>',"</span>"].join("")}else{if(i.id==="24"){j=['<span class="s-menu-item s-opacity-white-background" data-id="#{id}">',"<span>#{name}</span>",'<span class="bar-bg" data-tid="7999"></span>',"</span>"].join("")}else{j=['<span class="s-menu-item s-opacity-white-background" data-id="#{id}">',"#{name}","</span>"].join("")}}}return $.formatString(j,i)}function a(i){var j='<div id="s_content_#{id}" data-id="#{id}" class="s-content" style="display:none;"><div class="s-content-load s-opacity-white-background"><img src="#{staticUrl}static/mancard/img/loading_72b1da62.gif" /><div>加载中，精彩马上呈现</div></div></div>';$.extend(i,{staticUrl:s_domain.staticUrl});return $($.formatString(j,i))}function b(i,j){if(i.id==="5"&&!(i.childId)){i.childId="0"}i.isPull=(d||"");F.use("mancard:skeleton/model",function(k){k.get("cardHtml",function(l){j&&j(l)},i)})}return o})();return e});F.module("mancard:skeleton/model",function(i,l,j){var n="/home/pcweb/";function m(){}var h={waterHtml:function(c,d){var b=d.id||0,a=d.page||1;var e=$.Deferred();if(+d.noload===1){c&&c({html:""});e.resolve()}else{return $.ajaxget(n+"data/mancardwater?"+$.param(d),function(f){c&&c(f)})}return e},cardHtml:function(a,b){var c=$.param(b);$.ajaxget(n+"data/mancardhtml?"+c,function(d){a&&a(d)})}};var k={curmenu:function(a,b,d){var c=a||0;$.ajaxpost(n+"submit/mancardmenu",{id:a},function(e){b&&b(e)})}};m.prototype={get:function(c,a,b){return(h[c]&&h[c](a,b))||false},set:function(a,d,b,c){return(k[a]&&k[a](d,b,c))||false}};return new m()});F.module("mancard:skeleton/card_collection",function(l,n,o){var k=l("mancard:skeleton/card");var p=$("#s_menu_gurd");var i=$("#s_top_wrap");var m=$("#s_mancard_main .s-menu-container");function j(){this.pool={};this.curId=s_session.curmod;this._options={};this.menuTopShowed=false}j.prototype={constructor:j,add:function(b,a,c){if(b instanceof k){return(this.pool[b.id]=b)}else{if(typeof parseInt(b)=="number"&&a!=null&&c!=null){return(this.pool[""+b]=new k(b,a,c))}}return b},remove:function(a){if(a instanceof k){this.pool[a.id]=null}else{if(typeof parseInt(a)=="number"){this.pool[""+a]=null}}return a},get:function(a){return this.pool[""+a]},createCard:function(b,a,c){if(this.pool[b]){return this.pool[""+b]}return new k(b,a,c)},switchCard:function(c,a){var d=this;if($("#s_top_wrap").hasClass("s-down")){if(d.pool[""+c].waterPage==0){if($.isIE<9){d.fixIE(0,function(){})}else{window.scrollTo($(window).scrollLeft(),0)}}else{var b=Math.max($("#s_ctner_contents").offset().top-110,0);d.fixIE(b,function(){})}}d.cardDone(c,a)},cardDone:function(b,a){var c=this;c.pool[c.curId].hide(function(){window.s_session.curmod=c.curId=""+b;c.pool[""+b].show(function(){F.use("mancard:skeleton/model",function(d){d.set("curmenu",c.curId)});a&&a()})})},getMenuIDS:function(){var b=$("#s_menus_wrapper").find(".s-menu-item"),a=[];$.each(b,function(d,c){a.push($(c).attr("data-id"))});return a},toggleMenu:function(b,d){var a=this;var c=i.children(".s-top-nav");if(!!b){p.addClass("s-down");if($("#s_upfunc_menus .s-lite").hasClass("hide-icon")){c.append(p)}if(!a.menuTopShowed){c.css("display","block");p.css({marginTop:-1*p.height()}).stop().animate({marginTop:"0"},150)}a.menuTopShowed=true}else{if(d){p.removeClass("s-down");m.append(p)}else{p.css({marginTop:"0"}).stop().animate({marginTop:-1*p.height()},150,function(){c.css("display","none")})}a.menuTopShowed=false}o.fire("showTopMenu",{show:b})},options:function(){switch(arguments.length){case 0:return this._options;case 1:return this._options[arguments[0]];case 2:return(this._options[arguments[0]]=arguments[1])}},fixIE:function(b,a){var c=this;$("html,body").animate({scrollTop:b},500,function(){a&&a.call(c)})}};return new j()});F.addLog("mancard:skeleton/card_showLog",["cardItemShow"]);F.module("mancard:skeleton/card_showLog",function(s,p,v){var t=s("skeleton/card_collection");var x=s("skeleton/card_alsLog");var n=window.Thunder.get();var z={};var u=$(window).height();var y={logactid:"1100000004"};function w(){var l=$("#s_content_"+t.curId),m=l.find("[data-rid]"),h=null,g=z[t.curId]||[];var e=[],H=[],c=[],d={};var I=[];for(var i=0;i<m.length;i++){h=m.eq(i);var K=h.attr("data-extra");var j=h.attr("data-rid");var k;var b=h.attr("data-log");if(b){b=b.replace(/\;$/g,"")}if($.inArray(j,g)!=-1){continue}if((h.offset().top+h.height()/2)-$(window).scrollTop()<u){if(h.hasClass("s-nativead-item")){x.sendAlsShowLog({},{da_locate:+h.attr("data-locate"),extra_param:h.attr("data-extra-param")});var J=h.attr("data-cpm-rcv-url");if(J){r(J)}if(h.hasClass("nativead-empty-order")){g.push(j);continue}}if(/logactid/g.test(b)){if(b){q(b,d)}g.push(j);var a={};for(var i in d){a[i]=d[i].join(",")}v.fire("cardItemShow",a);continue}if($.inArray(j,g)==-1){e.push(j);var G={rid:j,extra:K,flow:2};if(b){q(b,d);o(b,G)}H.push(i);g.push(j);c.push(K);I.push(G)}}}z[t.curId]=g;if(e.length!=0){var a={rids:e.join(","),pos:H.join(","),extra:c.join(",")};for(var i in d){a[i]=d[i].join(",")}var f=$.extend({},y,a);v.fire("cardItemShow",f);logext_str=$.stringify(I);if(+s_session.curmod===2){n.send({cst:1,tid:27,logExtra:logext_str.substr(1,logext_str.length-2)})}}}function r(a){var b="cpm_rcv_url__"+(new Date()).getTime();var c=window[b]=new Image();c.onload=(c.onerror=function(){window[b]=null});c.src=a;c=null}function q(e,g){var d=[];var a="";var h="";var f="";var b=e.split(";");for(var c=0;c<b.length;c++){d=b[c].split(":");a=d[0];h=d[1];if(!/-0$/g.test(a)){if(/-1$/g.test(a)){a=a.replace(/-1$/g,"")}if(!g[a]){g[a]=[]}g[a].push(h)}}}function o(e,f){var d=[];var a="";var g="";var b=e.split(";");for(var c=0;c<b.length;c++){d=b[c].split(":");a=d[0];g=d[1];f[a]=g}}p.itemShowLog=w});F.module("mancard:skeleton/card_alsLog",function(l,h,i){function j(a){var b="imglog__"+(new Date()).getTime();var c=window[b]=new Image();c.onload=(c.onerror=function(){window[b]=null});c.src=a;c=null}var g={CLICK:2,SHOW:3};function k(){this.init()}k.prototype={constructor:k,init:function(){this.alsHostHttp="http://als.baidu.com/clog/clog";this.alsHostHttps="https://als.baidu.com/clog/clog";var c=39;var b=0;var a=$.cookie.get("BAIDUID");this.alsCommonFields=this.buildAlsParams(c,b,a)},buildAlsParams:function(c,b,a){return{productId:c,_client_type:b,baiduId:a}},sendAls:function(b){var a=[];for(var c in b){a.push([encodeURIComponent(c),"=",encodeURIComponent(b[c])].join(""))}j(this.alsHostHttps+"?"+a.join("&"))},buildAlsLogData:function(b,c){var a=encodeURIComponent($.stringify([$.extend({da_page:"index",da_page_num:1,da_locate:1,origin_time:+new Date()},c)]));return $.extend({},this.alsCommonFields,b,{ad:a})},sendAlsClickLog:function(a,b){this.sendAls(this.buildAlsLogData(a,$.extend(b,{da_type:g.CLICK})));return this},sendAlsShowLog:function(a,b){this.sendAls(this.buildAlsLogData(a,$.extend(b,{da_type:g.SHOW})));return this}};return new k()});F.module("mancard:skeleton/presenter",function(Q,E,G){var C=window;var S=Q("skeleton/card_collection");var T=Q("skeleton/card_showLog");var x=$("#s_mancard_main");var H=$("#s_ctner_menus");var P=$("#s_ctner_contents");var N=$(".s-menu-container",x);var L={};var M=$.parseJSON($.trim($("#s_menus_textarea",x).html()));var O=$(C).height();var J={};var U=true;function A(){D();K();if(s_session.sid.indexOf("18005")!==-1){R.initToolBar($.isIE===6)}}function D(){var d=M.data;var b=d.length;while(b--){var f=d[b];if(f.state==="1"){S.add(f.id,f.name,f.state)}}if(s_session.curmod==="3"){S.switchCard(100)}var a=S.get(s_session.curmod);if(C._card_aync){if(M.illegal){a.params.normal=1}a.show(function(){if(M.illegal){delete a.params.normal}})}else{a.rendered=true;a.noMore=!!parseInt(M.isEnd,10);a.sessionId=C.s_session.sessionId}for(var b=0,c=C.s_session.rids||[],e=c.length;b<e;b++){a.ridsHash[c[b]]=true}if(a.noMore){a.emitNoMore()}y.toggleMore(!parseInt(M.isEnd));setTimeout(function(){G.fire("modShow",{showTab:S.curId,opType:"refresh"});T.itemShowLog()},1000)}var R={latestY:$(C).scrollTop(),barTop:N.offset().top,barHeight:H.height(),topWrap:$("#s_top_wrap"),centTop:P.offset().top+parseInt(P.css("padding-top"),10),showed:false,overCenter:false,menuGurd:$("#s_menu_gurd",x),container:$(".s-menu-container",x),toolBar:$("#s_top_feed",x),toolBarTop:Math.min(parseInt($("#s_top_feed",x).css("top"),10),300),menuStatus:S.options("menuStatus",0),toggleMenu:function(b){if($.isIE===6){return}var d=this;if(b===d.latestY){return}var a=$.isIE==7?10:3;if((b<d.latestY)&&(d.barTop-b<=d.topWrap.height()+a)){if(!d.showed){S.toggleMenu(true);d.showed=true;S.options("menuStatus",1)}}else{var c=(d.barTop-b>d.topWrap.height()+a);if(d.showed){S.toggleMenu(false,c);d.showed=false}if(d.barTop-b>d.topWrap.height()){S.options("menuStatus",0)}else{S.options("menuStatus",2)}}if((d.centTop-b)<d.topWrap.height()){if(!d.overCenter){G.fire("overCenter",{over:true});d.overCenter=true}}else{if(d.overCenter){G.fire("overCenter",{over:false});d.overCenter=false}}d.latestY=b},judgeMenu:function(a){var b=this;if(a>0){b.toolBar.find(".to-top").css({visibility:"visible"})}else{b.toolBar.find(".to-top").css({visibility:"hidden"})}},initAdjust:function(){var a=$("#head_wrapper");$(C).on("unload",function(){$(".s-news-rank-wrapper",x).hide();a.removeClass("s-down");C.scrollTo(0,0)})},feedRoller:function(a){if($.isIE!==6){return}var b=this;_top=Math.min((b.toolBarTop+a),P.height()-b.toolBar.height());b.toolBar.css({top:_top})},initToolBar:function(b){var a=this;a.toolBar.css({visibility:"visible"});if(b){return}a.resetToolPos();$(C).on("resize",a.resetToolPos);$(C).on("scroll",a.resetToolPos);$(C).on("s-skinoff",a.resetToolPos);$(C).on("s-skinon",a.resetToolPos)},removeToolCalc:function(){var a=this;if($.isIE===6){return}a.resetToolPos(true)},resetToolPos:function(e){var b=R;var g;var d;var f=e===true?"animate":"css";if(!y.loaded){var d=$(C).height()-b.toolBar.height()-10;var a=P.offset().top+P.outerHeight()-b.toolBar.height()-$(C).scrollTop()-1;var c=P.offset().top+217-$(C).scrollTop();g=Math.max(Math.min(d,a),c)}else{var d=$(C).height()-b.toolBar.height()-30;var c=P.offset().top+227-$(C).scrollTop();g=Math.max(d,c)}if(b.rememberTop!==g){b.toolBar[f]({top:g});b.rememberTop=g}if($(window).width()<1000){b.toolBar.css({left:501-$(window).scrollLeft()})}else{b.toolBar.css({left:"50%"})}}};var y={defaulSub:300,tolerance:U?0:300,preTop:0,loaded:false,moreBar:x.find(".s-more-bar"),judgeFire:function(){var a=this;if(a.tolerance===0||s_session.index_off){return}S.get(S.curId).appendData(function(b){a.loaded=true;if(s_session.sid.indexOf("18005")!==-1){R.removeToolCalc()}},y.toggleMore)},toggleMore:function(a){if(!a){y.moreBar.remove()}else{y.moreBar.show()}},moreUpFy:function(b,f){var e=new Image();var d=this;y.moreBar.css({visibility:"visible"});if(f){if(d.moreUp){var c=P.offset().top+P.height()-$(C).height()-$(C).scrollTop();y.moreBar.css({bottom:Math.min(Math.max(0,c),10)})}}if($(C).height()<830){if(d.moreUp!==true){y.moreBar.addClass("s-more-up").appendTo(P);d.moreUp=true;var c=P.offset().top+P.height()-$(C).height()-$(C).scrollTop();y.moreBar.css({bottom:Math.min(Math.max(0,c),10)});function a(g){y.moreBar.find(".animate-arrow").animate({top:g?18:8},800,"swing",function(){a(!g)})}a(true)}}else{if(d.moreUp!==false){y.moreBar.removeClass("s-more-up");P.after(y.moreBar);if(!d.morePngLoaded){y.moreBar.find(".rect")[0].onload=function(){y.moreBar.css({visibility:"visible"})};d.morePngLoaded=true}d.moreUp=false}if(b===true){y.moreBar.find(".rect").attr("src",s_domain.staticUrl+"static/mancard/img/more_white_b67c5444.png")}else{if(b===false){y.moreBar.find(".rect").attr("src",s_domain.staticUrl+"static/mancard/img/more_black_279fd2db.png")}}}},moreDownFy:function(){if($(C).height()>700){var a=x.find(".s-more-bar").addClass("s-more-up").find(".rect").attr("src",s_domain.staticUrl+(C.s_session.userIsNewSkined==="on"?"static/mancard/img/more_white_b67c5444.png":"static/mancard/img/more_black_279fd2db.png")).end();P.after(a)}}};function z(){S.toggleMenu(true);R.showed=true;S.options("menuStatus",1)}function I(){var a={product_id:1};bds.qa.ShortCut.initRightBar(a);$("#fb_baidu_wizard").css({height:"100%"})}function K(){var a=null;H.delegate(".s-menu-item","click",function(g){var d=$(this);var f=d.attr("data-id");var e=S.curId;if(S.curId!==f){S.switchCard(f,function(){y.toggleMore(!parseInt(S.get(S.curId).waterPage)&&!S.get(S.curId).noMore)});y.toggleMore(!parseInt(S.get(S.curId).waterPage)&&!S.get(S.curId).noMore);G.fire("switchCard",{toCard:f,fromCard:e})}if(f=="100"){x.find(".mine-tips").hide()}F.use("mancard:setting/card_setting",function(h){h.hide()});setTimeout(function(){G.fire("modShow",{showTab:S.curId,opType:"click"});G.fire("modClick",{clickTab:S.curId});T.itemShowLog()},500);F.use("superman:common/user_attr",function(i){if(i.getAttr&&i.getAttr("firstMahattan")){var h=S.getMenuIDS().join(",");$.ajaxpost(s_domain.baseuri+"/pcweb/submit/mancardmod",{cmd:"sort",ids:h});i.setAttr("firstMahattan","off")}});g.stopPropagation()}).delegate(".s-menu-item","mouseenter",function(d){var e=$(this);var f=e.attr("data-id");var g=+new Date();L[f]={start:g};L[f].timeId=setTimeout(function(){if(!S.get(f).rendered){S.get(f).render()}},150);d.stopPropagation()}).delegate(".s-menu-item","mouseleave",function(h){var d=$(this);var f=d.attr("data-id");var g=L[f];var e=+new Date();if(g&&g.start){if(e-g.start<150){clearTimeout(g.timeId)}}h.stopPropagation()}).delegate(".s-menu-setting","click",function(d){F.use("mancard:setting/card_setting",function(e){if(!e.isShow()){e.show({current:$("#s_menus_wrapper").find(".current").attr("data-id")})}else{e.hide()}})}).delegate(".s-music-entry","mouseenter",function(){F.call("newmusic:player_exp","init")});x.delegate(".s-more-bar","click",function(d){y.tolerance=y.defaulSub;y.judgeFire();G.fire("loadMoreClick");d.stopPropagation()}).delegate(".to-top","click",function(d){$("body,html").animate({scrollTop:0});G.fire("gotoTopClick");d.stopPropagation()}).on("mouseenter mouseleave",".s-qrcode",function(d){var e=$(this);if(d.type==="mouseenter"){if($(C).width()<=1300){$("#s_top_feed .s-qrcode").addClass("minify")}else{$("#s_top_feed .s-qrcode").removeClass("minify")}e.addClass("icon-over");G.fire("qrcodehover")}else{if(d.type==="mouseleave"){e.removeClass("icon-over")}}d.stopPropagation()}).delegate("#s_top_feed .to-top","mouseenter mouseleave",function(d){if(d.type==="mouseenter"){$(this).addClass("icon-over")}else{if(d.type==="mouseleave"){$(this).removeClass("icon-over")}}d.stopPropagation()}).delegate("#s_qrcode_feed .qrcode-layer","mouseenter mouseleave",function(d){if(d.type==="mouseenter"){$(this).addClass("icon-over");$("#s_qrcode_feed .qrcode-tooltip").addClass("popup");$("#s_feedback_feed .feedback-tooltip").removeClass("popup")}else{if(d.type==="mouseleave"){$(this).removeClass("icon-over")}}d.stopPropagation()}).delegate("#s_qrcode_feed .qrcode-tooltip","mouseenter mouseleave",function(d){if(d.type==="mouseenter"){$(this).addClass("popup")}else{if(d.type==="mouseleave"){$(this).removeClass("popup")}}d.stopPropagation()}).delegate("#s_feedback_feed .feedback-layer","mouseenter mouseleave",function(d){if(d.type==="mouseenter"){$(this).addClass("icon-over");$("#s_feedback_feed .feedback-tooltip").addClass("popup");$("#s_qrcode_feed .qrcode-tooltip").removeClass("popup")}else{if(d.type==="mouseleave"){$(this).removeClass("icon-over")}}d.stopPropagation()}).delegate("#s_feedback_feed .feedback-tooltip","mouseenter mouseleave",function(d){if(d.type==="mouseenter"){$(this).addClass("popup")}else{if(d.type==="mouseleave"){$(this).removeClass("popup")}}d.stopPropagation()});G.listen("mancard:setting/card_setting",["hideMain","showSet","hideSet"],function(h){if(h.cmd==="add"){(S.get(h.id)||S.add(h.id,h.name,"1")).add2Men();a=h.id}else{if(h.cmd==="del"){var g=0;S.get(h.id).del4Men();for(g in S.pool){break}a=g}else{if(h.cmd==="sort"){var d=$("#s_menus_wrapper");$.each(h.ids,function(k,j){S.get(j).getMyMen().appendTo(d)})}else{if(h._EVENT_NAME==="hideMain"){var e=$("#s_top_wrap").hasClass("s-down")?(($.isIE===8||$.isIE===7)?2500:400):0;$("html,body").animate({scrollTop:0},e,function(){$("#head_wrapper").addClass("s-ps-islite");$("#s_main").hide();$("#s_mancard_newmusic").hide();$("#s_mancard_newmusic").remove();$("#s_upfunc_menus .s-lite").removeClass("hide-icon");F.use("superman:common/user_attr",function(j){j.setAttr("isLite",true)})})}else{if(h._EVENT_NAME==="showSet"){a=null}else{if(h._EVENT_NAME==="hideSet"){a=null;var d=$("#s_menus_wrapper");var f=S.getMenuIDS();var i=$(".s-menu-music");if(i.length>0&&i.css("display")!=="none"){f.unshift(i.attr("data-id"))}$.each(f,function(k,j){if($.inArray(j,h.ids)==-1){if(j==="3"){i.find(".s-music-entry").hide();F.call("newmusic:index","stop")}S.get(j).del4Men();S.get(j).getMyMen().removeClass("current")}});$.each(h.items,function(l,j){if(S.get(j.id)){var k=S.get(j.id).getMyMen();k.css("display","");if(j.id==="3"){k.appendTo(d.parent());i.find(".s-music-entry").show();$("#s_mancard_newmusic").show();F.call("newmusic:index","init")}else{k.appendTo(d)}if(k.hasClass("current")){a=j.id}}else{S.add(j.id,j.name,"1").add2Men()}});if(h.items.length===0||(h.items.length===1&&h.ids[0]==="3")){a="100"}if(s_session.curmod==="100"){return}if(a!==s_session.curmod){if(a!==null){S.switchCard(a)}else{a=h.ids[0]==="3"?h.ids[1]:h.ids[0];S.switchCard(a)}}}}}}}}});G.listen("superman:page/scroll","outMenu",function(d){if(!d.out){$("#s_top_wrap .s-top-nav").css("display","none")}});y.moreUpFy();$(C).bind("resize",function(d){O=$(this).height();R.barTop=N.offset().top;y.moreUpFy(undefined,true)}).on("scroll",function(f){if(s_session.index_off||s_session.index_guide){return}var d=$(this).scrollTop();var e=$(document).height();if(Math.abs(d+O-e)<=y.tolerance&&y.preTop<d){y.judgeFire()}y.preTop=d;R.judgeMenu(d);R.toggleMenu(d);R.feedRoller(d);setTimeout(function(){T.itemShowLog()},300);y.moreUpFy(undefined,true)});$(C).on("s-skinon",function(){y.moreUpFy(true)});$(C).on("s-skinoff",function(){y.moreUpFy(false)});$(document.body).on("mousewheel",b).on("keydown",b);function b(d){if(s_session.index_guide){return}if((document.documentElement.scrollHeight<=document.documentElement.clientHeight&&d.deltaY<0)||($(C).scrollTop()+$(C).height()-$(document).height()>=-2&&y.tolerance===0&&(d.deltaY<0||d.keyCode===40))){y.tolerance=y.defaulSub;y.judgeFire()}}var c=false;G.listen("mancard:skeleton/card","beforeLoading",function(){if(!c){$("#bottom_container").appendTo("#s_wrap");c=true}})}function B(){T.itemShowLog();setTimeout(function(){G.fire("modShow",{showTab:S.curId,opType:"refresh"})},1000)}E.init=A;E.forceMenu=z;E.judgeFire=function(){y.tolerance=300;y.judgeFire()}});F.call("mancard:skeleton/presenter","init");F.module("mancard:skeleton/card_tab",function(j,k,l){var n=j("skeleton/card_collection");var i=/childId=(.+);/;var m=/lasttab/;function h(a){this.initialize(a)}h.prototype={initialize:function(a){var b=this;var d=F.mix({cardName:null,componentWrap:null,content:null,cardTabClass:"card-tab",tabNameClass:"tab-name",tabNameCurClass:"tab-name-cur",tabContentClass:"tab-content",tabContentWrapClass:"tab-content-wrap",dataTabName:"data-childid"},a);b.cardName=d.cardName;b.componentWrap=d.componentWrap;b.content=d.content;b.tabNameClass=d.tabNameClass;b.tabNameCurClass=d.tabNameCurClass;b.tabContentClass=d.tabContentClass;b.dataTabName=d.dataTabName;b.mainDom=b.componentWrap.parent();var c=b.mainDom.attr("data-id");b.card=n.get(c);b.sessionIds={};b.offsets={};b.noMores={};b.dataWaterPara="";b.render(d);b.bindEvent()},render:function(a){var b=this;b.tabs=b.componentWrap.find("."+a.cardTabClass);b.curTab=b.tabs.find("."+b.tabNameCurClass).attr(b.dataTabName);b.dataWaterPara=b.mainDom.attr("data-waterpara")||"";if(!b.dataWaterPara.match(i)){b.dataWaterPara=b.dataWaterPara+"childId="+b.curTab+";";b.mainDom.attr("data-waterpara",b.dataWaterPara)}b.componentWrap.attr("data-curtab",b.curTab);b.content.wrap('<div class="'+a.tabContentWrapClass+'"></div>');b.contentWrap=b.componentWrap.find("."+a.tabContentWrapClass);b.content.addClass("tab-content").attr(b.dataTabName,b.curTab).attr("data-load","loaded").show();b.sessionIds[b.curTab]=b.card.sessionId;b.offsets[b.curTab]=b.card.waterPage;b.noMores[b.curTab]=b.card.noMore},bindEvent:function(){var a=this;var c=['<div class="s-content-load s-opacity-white-background">','<img src="#{staticUrl}static/mancard/img/loading_72b1da62.gif" />',"<div>加载中，精彩马上呈现</div>","</div>"].join("");c=$.formatString(c,{staticUrl:s_domain.staticUrl});var b;l.listen("mancard:skeleton/card",["syncNomore"],function(d){a.sessionIds[b]=a.card.sessionId;a.card.sessionId=a.sessionIds[a.curTab];a.card.noMore=true;a.noMores[b]=a.card.noMore;a.contentWrap.find("["+a.dataTabName+'="'+b+'"]').attr("data-load","loaded").append(d);a.card.setForceLoad(false)});a.tabs.delegate("."+a.tabNameClass,"mouseenter",function(f){var g=this;var p=$(this).prop("className");if(m.exec(p)&&m.exec(p)[0]==="lasttab"){return}var e=$(this).attr(a.dataTabName);b=e;var d=a.contentWrap.find("["+a.dataTabName+'="'+e+'"]');if(d.length===0){d=$('<div class="'+a.tabContentClass+'"></div>').attr(a.dataTabName,e).appendTo(a.contentWrap);d.attr("data-load","loading").append(c);a.card.setForceLoad(true);a.card.addParam("childId",e);a.card.load(function(o){a.sessionIds[e]=a.card.sessionId;a.card.sessionId=a.sessionIds[a.curTab];a.card.noMore=a.noMores[e]||false;a.noMores[e]=a.card.noMore;a.card.ridsHash={};d.attr("data-load","loaded").append(o);a.card.setForceLoad(false);if(a.curTab===e){if(!$(g).attr("data-firstLoad")){a.card.waterLoading=false;a.card.appendData(function(r){$("#s_mancard_main").find(".s-more-bar").hide();$(g).attr("data-firstLoad",1)},false,d)}}a.contentWrap.find(".s-content-load").remove()})}}).delegate("."+a.tabNameClass,"click",function(t){var e=this;t.stopPropagation();var d=$(this).prop("className");if(m.exec(d)&&m.exec(d)[0]==="lasttab"){l.fire("clicklastTab");return}$(e).trigger("mouseenter");var s=a.tabs.find("."+a.tabNameCurClass).removeClass(a.tabNameCurClass).attr(a.dataTabName);var r=$(this).addClass(a.tabNameCurClass).attr(a.dataTabName);a.dataWaterPara=a.dataWaterPara.replace(i,"childId="+r+";");a.mainDom.attr("data-waterpara",a.dataWaterPara);l.fire("clickTab",{tabName:$(this).prop("className"),childId:$(this).attr("data-childid")});if(s===r){return}a.offsets[s]=a.card.waterPage;a.noMores[s]=a.card.noMore;a.card.waterPage=a.offsets[r]||0;a.card.noMore=a.noMores[r]||false;a.card.ridsHash={};a.card.sessionId=a.sessionIds[r];if(!a.card.noMore){a.card.resetNoMore()}else{$(".load-done").remove();$(".s-content-load").remove();a.card.emitNoMore()}var f=a.contentWrap.find("["+a.dataTabName+'="'+s+'"]');var g=f.siblings("["+a.dataTabName+'="'+r+'"]');f.hide();g.show();a.curTab=r;if(a.card.id!="5"){a.setTargetTab(r)}a.card.waterDom=g;if(!a.sessionIds[r]){return}a.card.waterLoading=false;if(!$(e).attr("data-firstLoad")){a.card.appendData(function(o){$("#s_mancard_main").find(".s-more-bar").hide();$(e).attr("data-firstLoad",1)},false,g)}})},setTargetTab:function(b,a){var c=this;F.use("mancard:skeleton/card_memory",function(d){d.setCardTab(c.cardName,b);a&&a()})}};return h});F.module("mancard:setting/card_setting",function(W,R,N){var S=W("superui:util/emitter"),H=W("superui:util/dot"),C=W("superman:common/user_attr"),aa=H.compile(['<div class="s-cardsetting" id="s_content_99" data-id="99">','<div class="s-cardsetting-wrap clearfix">','<div class="s-cardsetting-left">',"<h3>已订阅频道</h3>",'<div style="float:left;width:78px;text-align:center;margin-top:18px;border:1px solid #cdcdcd;height:24px;line-height:24px;">我的关注</div>','<div class="s-cardsetting-content">',"{{~it.selected :value:index}}",'{{? (value.name!="音乐")}}','<div class="s-mod-item" id="s_moditem_{{=value.id}}" data-id="{{=value.id}}" data-imgname="{{=value.imgname}}" data-name="{{=value.name}}"{{ if(value.name == "音乐"&&!it.showMusic){ }} style="display:none;"{{ } }}>','<div class="s-mod-icon">',"</div>",'<div class="s-mod-title">',"{{=value.name}}","</div>","</div>","{{?? it.showMusic}}",'<div class="s-mod-item s-mod-music s-mod-undraggable" id="s_moditem_{{=value.id}}" data-id="{{=value.id}}" data-imgname="{{=value.imgname}}" data-name="{{=value.name}}"{{ if(value.name == "音乐"&&!it.showMusic){ }} style="display:none;"{{ } }}>','<div class="s-mod-icon">',"</div>",'<div class="s-mod-title">',"{{=value.name}}","</div>","</div>","{{?}}","{{~}}",'<div class="noremove-tips">','<p>亲，就剩我老哥一个了，不能再删了~可以尝试点击右下角“<a class="tips-hide" href="javascript:void(0)">隐藏频道</a>”收起全部内容。</p>','<b class="close-icon" title="关闭"></b>',"</div>",'<div class="drag-tips">','<p>拖动可以排序<a class="i" href="javascript:void(0)">我知道了</a></p>',"<b></b>","</div>","</div>","</div>",'<div class="s-cardsetting-right">',"<h3>未订阅频道</h3>",'<div class="s-cardsetting-content">',"{{~it.unselected :value:index}}",'{{? (value.name!="音乐")}}','<div class="s-mod-item" id="s_moditem_{{=value.id}}" data-id="{{=value.id}}" data-imgname="{{=value.imgname}}" data-name="{{=value.name}}"{{ if(value.name == "音乐"&&!it.showMusic){ }} style="display:none;"{{ } }}>','<div class="s-mod-icon">',"</div>",'<div class="s-mod-title">',"{{=value.name}}","</div>","</div>","{{?? it.showMusic}}",'<div class="s-mod-item s-mod-music s-mod-undraggable" id="s_moditem_{{=value.id}}" data-id="{{=value.id}}" data-imgname="{{=value.imgname}}" data-name="{{=value.name}}"{{ if(value.name == "音乐"&&!it.showMusic){ }} style="display:none;"{{ } }}>','<div class="s-mod-icon">',"</div>",'<div class="s-mod-title">',"{{=value.name}}","</div>","</div>","{{?}}","{{~}}","</div>","</div>","</div>",'<div class="s-cardsetting-set-wrapper">','<div class="s-cardsetting-set clearfix">',"{{? it.expand}}","{{~it.expand :value:index}}","{{? value.tipsunknown}}",'<span class="scene-recomm-unknown"></span>',"{{?}}",'<a href="#" onclick="return false;"  class="hide-mods {{=value.otherClassName}}"  hidefocus><span class="{{=value.borderClass}} {{=value.reviewCheck}}" id="{{=value.myId}}" data-attr="{{=value.tips}}"></span><span>{{=value.description}}</span></a>',"{{~}}",'<a href="#" onclick="return false;" class="hide-mods" id="s_hide_allmods" hidefocus=""><span class="bg"></span><span>隐藏频道</span></a>',"{{?}}","</div>","</div>","</div>"].join("")),Y='<div class="s-mod-tips">',K="",V="拖动到这里可以取消订阅",G="mod-hover",Z="hide-mods",E="."+Z,U="s-mod-item",X="."+U,L=".s-cardsetting-left .s-cardsetting-content",Q=".s-cardsetting-right .s-cardsetting-content",P=W("superui:component/draggselect"),M=W("superman:common/user_attr"),ad=W("superui:component/dialog"),J=W("superui:component"),O=true,T=false,ae=W("skeleton/card_collection"),D={mod:s_domain.baseuri+"/pcweb/submit/mancardmod",menu:s_domain.baseuri+"/pcweb/submit/mancardmenu"},I;var ac=null;function ab(){this.initialize()}ab.prototype={constructor:ab,initialize:function(){this.main=$("#s_main");this.textarea=$("#s_menus_textarea");this.addedcache=[];if(this.textarea.length){this.selected=[];this.unselected=[];this.cache=$.parseJSON(this.textarea.val());this.render()}this.__datas=[]},renderTips:function(){var b,a=this;a.dialog.body.on("click",".scene-recomm-unknown",function(){if(!b){F.use("superui:component/tips",function(c){var d=$(".scene-recomm-unknown",a.dialog.body);b=new c({componentWrap:a.dialog.body,target:d,identity:"scene-recommend",content:['<div class="scene-recommend-content">','<div class="scene-recommend-content">',"<h2>情景推荐模式：</h2>",'<p class="title">即当您登录百度首页时，页面会优先切换到您此时可能感兴趣的内容。</p>',"<p>例：您习惯看各种资讯，一大早打开电脑，会优先给您推荐新闻；闲暇时会给您切换至视频卡片供您舒缓神经。</p>",'<p class="last s-opacity-border4-top">如若您不喜欢，取消勾选框中的√即可，感谢您的使用~</p>',"</div>"].join(""),align:"center",arrowLeft:"right",autoShow:false,hasClose:false,width:388,theme:"scene-recommend"})})}b.show()})},render:function(){var a=this,c=[];var b=null;F.each(a.cache.data,function(d){if(+d.id===100){b=d}if(+d.ismenu===1){if(+d.state===1){if(+d.id===3){a.selected.unshift(d);if(!window.s_session.audioModernizr){I=d.id}}else{a.selected.push(d)}}else{a.unselected.push(d)}}});if(s_session.strategy_hit===2){c.push({otherClassName:"content-mod",borderClass:"choice-border",tips:"mouseScrollGuide",myId:"mouseScroll_mod",description:"滚轮切换卡片",reviewCheck:s_session.userTips.mouseScrollGuide?"checked":""})}c.push({otherClassName:"content-mod",borderClass:"choice-border",tips:"conRecommendTip",myId:"conRecommend_mod",description:"情景推荐",tipsunknown:true,reviewCheck:s_session.userTips.conRecommendTip?"checked":""});a.expand=c},init:function(){var a=this;dialog=a.dialog;dialog.body.on("mouseenter mouseleave",X,function(b){var c=$(b.target).closest(X);c[b.type=="mouseenter"?"addClass":"removeClass"](G)});a.bindDrag();dialog.on("onHide",function(d){$("#s_main").removeClass("sui-cardsetting-main");s_session.skeleton_stopanimated=false;var c=a.getItems(),b={};N.fire("hideSet",c);a.dialog.log("hide")});a.bindEvent()},bindEvent:function(){var b=this,a=b.dialog.body.find(".drag-tips"),c=b.dialog.body.find(".tips-hide"),d=b.dialog.body.find(".close-icon");a.on("click",function(){F.use("common/user_attr",function(e){e.setAttr("settingDragTips",false);a.css("display","none")})});c.on("click",function(e){b.hideMain();e.stopPropagation()});$(document).on("mousedown",function(e){if($(e.target).hasClass("menu-icon")){return}b.hide();T=false});d.on("click",function(e){b.dialog.body.find(L).find(".noremove-tips").css("display","none")});N.listen("mancard:skeleton/presenter","overCenter",function(e){if(!!e.over){b.hide()}});N.listen("mancard:skeleton/card_collection","showTopMenu",function(e){if(!e.show){b.hide()}});$(window).on("scroll",function(){})},save:function(){var a=this,b=a.packed;setTimeout(function(){N.fire("modOperate",b)},100)},pack:function(c){var b=this,a,d=c.dragItem;b.packed={ismenu:1,cmd:c.type=="added"?"add":c.type=="remove"?"del":"sort"};a=b.getIDS();b.packed.ids=a.ids;b.packed.names=a.names;if(d){b.packed.id=d.attr("data-id");b.packed.name=d.attr("data-name")}b.save()},getIDS:function(){var c={ids:[],names:[]},b=this.draggselect.selected,d=b.drags,a=b.cache;F.each(a,function(e){var f=d.eq(e),h=f.attr("data-id"),g=f.attr("data-name");c.ids.push(h);c.names.push(g)});return c},getItems:function(){var a=[],d=[],c=this.draggselect.selected,e=c.drags,b=c.cache;F.each(b,function(f){var g=e.eq(f),i=g.attr("data-id"),h=g.attr("data-name");d.push(i);a.push({name:h,id:i})});return{ids:d,items:a}},tips:function(){var b=this,c,d,a=b.draggselect;c=a.selected;d=a.unselected;if(!c.tipsmessage){c.tipsmessage=$(Y).html(V).appendTo(c.wrap)}if(!d.tipsmessage){d.tipsmessage=$(Y).html(K).appendTo(d.wrap)}if(c.total==0){d.tipsmessage.show();c.tipsmessage.hide()}else{d.tipsmessage.hide();if(d.total==0){d.tipsmessage.hide();c.tipsmessage.show()}else{c.tipsmessage.hide()}}d.tipsmessage.hide()},cacheAdded:function(e){var b=this,a,d,c=this.addedcache;if(e.dragItem){d=e.dragItem.attr("data-id");a=$.inArray(d,c);if(a>-1){c.splice(a,1)}if(e.type=="added"){c.push(d)}}},bindDrag:function(){var a=this,c=a.dialog,b;if(c.body.find(L).width()>530){a.bugtotal=a.bugtotal||0;if(a.bugtotal++<100){return setTimeout(function(){a.bindDrag()},200)}}a.draggselect=new P({identity:"cardsetting",containment:c.body,selected:c.body.find(L),unselected:c.body.find(Q),dragsort:X,cansort:false,afterAnimateTime:100});a.draggselect.on("onBeforeSelect",function(d){ac=d.dragItem;ac.css("zoom","0");var e=d.dragItem.parent().parent();a.dialog.body.find(".drag-tips").css("display","none");if(d.dragItem){d.dragItem.removeClass(G);if(ac.text()==="音乐"){$(".sui-draggsort-holder").addClass("lock");a.draggselect.selected.__options.cansort=false}}});a.draggselect.on("onAfterSelect",function(d){setTimeout(function(){a.resort()},a.draggselect.selected.__options.afterAnimateTime+50);a.draggselect.selected.__options.cansort=true;if(ac){setTimeout(function(){ac.css("zoom","1");ac=null},50)}$(".sui-draggsort-holder").removeClass("lock")});a.draggselect.on("onBeforeSelectSwap",function(){a.dialog.body.find(".drag-tips").css("display","none");a.draggselect.selected.parentoffset=$(".s-cardsetting-left .s-cardsetting-content").offset();a.draggselect.unselected.parentoffset=$(".s-cardsetting-right .s-cardsetting-content").offset()});a.draggselect.on("onSelectSwap",function(j){j.dragItem&&j.dragItem.removeClass("mod-hover");if(j.dragItem&&$.isIE){j.dragItem.removeClass("mod-hover");setTimeout(function(){},100)}a.checkLeave();switch(j.type){case"added":cmd="add";break;case"remove":cmd="del";var k=j.dragItem,g,i;a.cacheAdded(j);if(k&&k.length){if(j.type=="remove"){a.tips(true)}else{a.tips()}k.removeClass(G)}break;case"noremove":a.dialog.body.find(".drag-tips").hide();break;case"switch":cmd="sort";break}if(!ac){a.resort()}a.pack(j);if(s_session.userTips.firstMahattan){F.use("superman:common/user_attr",function(l){l.setAttr("firstMahattan",false)})}$.ajaxpost(D.mod,{cmd:a.packed.cmd,id:j.dragItem?j.dragItem.attr("data-id"):undefined,ids:a.getModIds(a.packed.ids)},function(l){});var e=ae.getMenuIDS();var h=a.getItems().ids;for(var f=0;f<e.length;f++){var d=ae.get(e[f]).getMyMen();if(d.hasClass("current")&&$.inArray(e[f],h)==-1){$.ajaxpost(D.menu,{id:h[0]},function(l){})}}});a.draggselect.on("onAfterSelect",function(d){T=true;a.checkLeave()});a.draggselect.on("onResizeHeight",function(d){});a.draggselect.on("beforeMoving",function(){c.body.find(L).find(".noremove-tips").css("display","none")});a.bindExpand();a.renderTips();a.tips(true);a.checkLeave()},checkLeave:function(){var a=this;leftHave=a.dialog.body.find(L).find(X).length;O=leftHave==1?false:true},bindExpand:function(){var b=this,a=b.dialog;a.body.on("click",function(d){var c=$(d.target).closest(E),f,g,e;if(c.length){f=c.find("span").eq(0);if(g=f.attr("data-attr")){e=f.toggleClass("checked").hasClass("checked");M.setAttr(g,e);b.draggselect.log(g,"checked="+e)}else{b.draggselect.log("hidemain");b.hideMain()}return false}})},hideMain:function(a){if(!a){this.dialog.hide()}N.fire("hideMain");$("body").addClass("is-lite")},show:function(b){var a=this,c;a.current=b.current;if(a.cache){if(!a.dialog){$("#s_main").addClass("sui-cardsetting-main");a.dialog=new ad({identity:"cardsetting",width:c=a.main.width(),content:aa({expand:a.expand,unselected:a.unselected,selected:a.selected,showMusic:window.s_session.audioModernizr}),position:function(){return{top:"36px",width:"895px",left:"0px"}},theme:"cardsetting",autoShow:false,hasMask:false,hasClose:false,componentWrap:$("#s_main"),hackToTop:false});a.dialog.on("onShow",function(){$("#s_main").addClass("sui-cardsetting-main");s_session.skeleton_stopanimated=true;if(!a.binded){setTimeout(function(){a.init(a.binded=true)},100)}})}if(!s_session.userTips.settingDragTips||a.selected.length==0){a.dialog.body.find(".drag-tips").css("display","none")}a.dialog.show();a.beforeShow();if($.isIE6){$(".sui-dialog-cardsetting .sui-dialog-body").show()}else{if(true){$(".sui-dialog-cardsetting .sui-dialog-body").css({display:"block"});$(".sui-dialog-cardsetting").animate({height:"186px"},200)}else{}}N.fire("showSet")}a.dialog.hasshow=true;$(".sui-dialog-body").on("click",function(d){d.stopPropagation()});a.dialog.body.on("mousedown",function(d){d.stopPropagation()});F.use("common/user_attr",function(d){d.setAttr("settingDragTips",false)})},hide:function(){var a=this;if(a.isShow()){if($.isIE6){$(".sui-dialog-cardsetting .sui-dialog-body").hide();a.dialog.hide()}else{$(".sui-dialog-cardsetting").animate({height:"0px"},200,function(){$(".sui-dialog-cardsetting .sui-dialog-body").css({display:"none"});a.dialog.hide()})}}},isShow:function(){if($(".sui-dialog-cardsetting .sui-dialog-body").length==0||$(".sui-dialog-cardsetting .sui-dialog-body").css("display")=="none"){return false}else{return true}},beforeShow:function(){var a=this,b=$("#s_top_wrap"),c=$(".sui-dialog-cardsetting");if(b.find("#s_menu_gurd").length>0){if($.isIE6){c.css("position","absolute");c.css("top",$(window).scrollTop()-$("#s_main").offset().top+110+"px")}else{c.css("position","fixed");c.css("top","110px");c.css("left",$("#s_main").offset().left)}}else{c.css("position","absolute");c.css("top","36px")}},resort:function(){var a=this.draggselect.selected.cache;var b=parseInt($(".s-cardsetting-left .s-mod-music:last").attr("data-daraggsort"),10);if(!isNaN(b)){var c;for(var e=0,d=a.length;e<d;e++){if(b===a[e]&&e!==0){a.splice(e,1);a.unshift(b);this.draggselect.selected.sort(false,true);break}}}},getModIds:function(a){var a=a;if(I!==undefined&&!($.inArray(a,I)>-1)){a.unshift(I)}return a.join(",")}};return new (F.inherit(ab,S))()});F.module("mancard:subscribe/parabola",function(M,b,I){(function(){var f=0;var e=["webkit","moz"];for(var d=0;d<e.length&&!window.requestAnimationFrame;++d){window.requestAnimationFrame=window[e[d]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[e[d]+"CancelAnimationFrame"]||window[e[d]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(j,h){var g=new Date().getTime();var i=Math.max(0,16.7-(g-f));var k=window.setTimeout(function(){j(g+i)},i);f=g+i;return k}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(g){clearTimeout(g)}}}());var L={speed:166.67,curvature:0.001,progress:function(){},complete:function(){N&&N()}};var S,c,N;var B={},O=O||{};for(var a in L){B[a]=O[a]||L[a]}b={mark:function(){return this},position:function(){return this},move:function(){return this},init:function(){return this}};var R="margin",z=document.createElement("div");if("oninput" in z){["","ms","webkit"].forEach(function(d){var e=d+(d?"T":"t")+"ransform";if(e in z.style){R=e}})}var J=B.curvature,A=0,C=0;var H=true;var D={},K={};var P={},E={};var Q={},G={};b.mark=function(){if(H==false){return this}if(typeof Q.x=="undefined"){this.position()}S.setAttribute("data-center",[Q.x,Q.y].join());c.setAttribute("data-center",[G.x,G.y].join());return this};b.position=function(){if(H==false){return this}var d=document.documentElement.scrollLeft||document.body.scrollLeft,e=document.documentElement.scrollTop||document.body.scrollTop;if(R=="margin"){S.style.marginLeft=S.style.marginTop="0px"}else{S.style[R]="translate(0, 0)"}D=S.getBoundingClientRect();K=c.getBoundingClientRect();P={x:D.left+(D.right-D.left)/2+d,y:D.top+(D.bottom-D.top)/2+e};E={x:K.left+(K.right-K.left)/2+d,y:K.top+(K.bottom-K.top)/2+e};Q={x:0,y:0};G={x:-1*(P.x-E.x),y:-1*(P.y-E.y)};A=(G.y-J*G.x*G.x)/G.x;return this};b.move=function(){if(H==false){return this}var d=0,f=G.x>0?1:-1;var e=function(){var i=2*J*d+A;d=d+f*Math.sqrt(B.speed/(i*i+1));if((f==1&&d>G.x)||(f==-1&&d<G.x)){d=G.x}var g=d,h=J*g*g+A*g;S.setAttribute("data-center",[Math.round(g),Math.round(h)].join());if(R=="margin"){S.style.marginLeft=g+"px";S.style.marginTop=h+"px"}else{S.style[R]="translate("+[g+"px",h+"px"].join()+")"}if(d!==G.x){B.progress(g,h);window.requestAnimationFrame(e)}else{B.complete();H=true}};window.requestAnimationFrame(e);H=false;return this};b.init=function(e,f,d){S=e;c=f;N=d;this.position().mark().move()};return b});F.module("mancard:subscribe/subscribe",function(N,H,G){var T=N("mancard:skeleton/card_collection");var y=["s_ctner_contents"],B=false,M,C=$('<div class="sub-anistar"><b></b></div>'),E=$('<div class="sub-anipic">							<div class="sub-ie-mask"></div>						</div>'),D=[],U=$('<div class="sub-aniadd"></div>'),L=$('<div class="sub-anistaradd"></div>'),W=$("#head"),I=s_domain.baseuri+"/subscribe/submit/manoperation ",O="data-subscribe",J="data-rid",P="data-subparam",R=0;var S=N("superui:component/tips");var V=function(a){$("#"+a).on("mouseenter mouseleave","["+O+"]",function(c){var b=c.target;if(c.type==="mouseenter"){window.debugenter=function(){var e;if((e=$(this).find(".subscribe"))[0]){e.show();if($(this).attr(O)=="1"){Q("1",e)}else{Q("0",e)}return}var d=$('<div class="subscribe" data-click="LOG_BTN_SUB"><div class="sub"><em class="sub-bg"></em><b class="sub-star"></b><span class="sub-txt" style="display:none">已关注</span></div></div>');if($(this).attr(O)=="1"){Q("1",d)}else{Q("0",d)}if($(this).find(".sub-contaniner").length>0){$(this).find(".sub-contaniner").append(d)}else{$(this).append(d)}if($.isIE6){d.css("zoom","1")}};window.debugenter.call(this)}else{if(c.target!=$(this).find(".subscribe").find(".sub-star")[0]){$(this).find(".subscribe").css("zoom","0").detach()}}}).on("click",".subscribe",function(b){z($(this),$(this));b.stopPropagation()})};var Q=function(a,b){var c=b.children();if(a=="1"){c.removeClass("unsub");c.addClass("sub");b.attr("data-click","LOG_BTN_UNSUB");b.find(".sub-txt").text("已关注");if(s_session.curmod=="20"){b.attr("title","已关注,点击取消")}}else{if(a=="0"){c.removeClass("sub");c.addClass("unsub");b.attr("data-click","LOG_BTN_SUB");b.find(".sub-txt").text("关注");if(s_session.curmod=="20"){b.attr("title","添加到关注")}}}};var z=function(b,d){var f=b,g=f.parents("["+O+"]"),c=g.attr(O),k=g.attr(J),a=g.attr(P),e,j={id:k};if(a){var h=/([^:]+):([^;]+);/gi,i;while((i=h.exec(a))){j[i[1]]=i[2]}}if(c=="1"){e="del";j.cmd=e;K(g,j,function(){g.attr(O,"0");Q("0",d)})}else{e="add";j.cmd=e;A(g,j,function(){g.attr(O,"1");Q("1",d)})}g.parents(".s-xmancard").attr("data-subChange",1)};function A(c,b,a){var h=c.offset();var f=$("#s_menu_mine .mine-icon").offset();var d=E.clone();d.attr("class","sub-anipic sub-anipic-"+s_session.curmod);var g=c.closest("["+J+"]").find("img").attr("src");var e={tabid:window.s_session.curmod,url:c.find("a").attr("href")||"",name:c.find("a").attr("title")||"",from:window.s_session.curmod};$.extend(e,b);$.ajaxpost(I,e,function(i){var j=i.errNo;if(j=="0"||j=="6004"){a&&a();G.fire("refresh",{tabid:e.tabid,param:e,response:i,actItem:c});if($.isIE6){return}if($.isIE&&$.browser.ie<9&&s_session.userSkinOpacity>20){d.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src='"+g+"')"})}else{d.css({"background-image":"url("+g+")"});d.css({filter:"none"})}setTimeout(function(){f=$("#s_menu_mine .mine-icon").offset();var k=-parseInt($("#s_menu_gurd").css("margin-top"),10);d.animate({left:f.left-10+"px",top:f.top-7+k+"px"},1000,function(){d.fadeOut(function(){d.remove()});var l=L.clone();l.css({left:f.left,top:f.top});W.append(l);l.show();l.animate({top:f.top-40,opacity:"0"},2000,function(m){l.remove()})})},0);d.css({left:h.left+45,top:h.top});W.append(d);if(T.options("menuStatus")=="2"||T.options("menuStatus")=="1"){F.call("mancard:skeleton/presenter","forceMenu")}}else{if(j=="501"){G.fire("showExceedTips",{tabid:e.tabid})}else{}}})}function K(b,a,d){var c={tabid:window.s_session.curmod,url:b.find("a").attr("href")||"",name:b.find("a").attr("title")||"",from:window.s_session.curmod};$.extend(c,a);$.ajaxpost(I,c,function(e){var f=e.errNo;if(f=="0"){d&&d();setTimeout(function(){G.fire("refresh",{tabid:c.tabid,param:c,response:e,actItem:b})},1000)}else{}})}H.init=function(){$.each(y,function(b,a){V(a)})};H.subAdd=A;H.subDel=K});F.call("mancard:subscribe/subscribe","init");